#!/usr/bin/env python

from argparse import ArgumentParser

import numpy as np
import openmc

parser = ArgumentParser()
parser.add_argument('-s', '--size', action='store', default='small',
                    help='Size of nuclide inventory (small or large)')
args = parser.parse_args()

# Define materials
fuel = openmc.Material(name='Fuel', material_id=1)
fuel.set_density('g/cm3', 10.062)
fuel.add_nuclide("U-234", 4.9476e-6)
fuel.add_nuclide("U-235", 4.8218e-4)
fuel.add_nuclide("U-236", 9.0402e-5)
fuel.add_nuclide("U-238", 2.1504e-2)
fuel.add_nuclide("Np-237", 7.3733e-6)
fuel.add_nuclide("Pu-238", 1.5148e-6)
fuel.add_nuclide("Pu-239", 1.3955e-4)
fuel.add_nuclide("Pu-240", 3.4405e-5)
fuel.add_nuclide("Pu-241", 2.1439e-5)
fuel.add_nuclide("Pu-242", 3.7422e-6)
fuel.add_nuclide("Am-241", 4.5041e-7)
fuel.add_nuclide("Am-242m", 9.2301e-9)
fuel.add_nuclide("Am-243", 4.7878e-7)
fuel.add_nuclide("Cm-242", 1.0485e-7)
fuel.add_nuclide("Cm-243", 1.4268e-9)
fuel.add_nuclide("Cm-244", 8.8756e-8)
fuel.add_nuclide("Cm-245", 3.5285e-9)
fuel.add_nuclide("Mo-95", 2.6497e-5)
fuel.add_nuclide("Tc-99", 3.2772e-5)
fuel.add_nuclide("Ru-101", 3.0742e-5)
fuel.add_nuclide("Ru-103", 2.3505e-6)
fuel.add_nuclide("Ag-109", 2.0009e-6)
fuel.add_nuclide("Xe-135", 1.0801e-8)
fuel.add_nuclide("Cs-133", 3.4612e-5)
fuel.add_nuclide("Nd-143", 2.6078e-5)
fuel.add_nuclide("Nd-145", 1.9898e-5)
fuel.add_nuclide("Sm-147", 1.6128e-6)
fuel.add_nuclide("Sm-149", 1.1627e-7)
fuel.add_nuclide("Sm-150", 7.1727e-6)
fuel.add_nuclide("Sm-151", 5.4947e-7)
fuel.add_nuclide("Sm-152", 3.0221e-6)
fuel.add_nuclide("Eu-153", 2.6209e-6)
fuel.add_nuclide("Gd-155", 1.5369e-9)
fuel.add_nuclide("O-16", 4.5737e-2)

# For H-M large, add all minor actinides and fission products
if args.size == 'large':
    # fission products from all actinides
    fuel.add_nuclide('Cu-65', 1.0e-12)
    fuel.add_nuclide('Zn-66', 1.0e-12)
    fuel.add_nuclide('Zn-67', 1.0e-12)
    fuel.add_nuclide('Zn-68', 1.0e-12)
    fuel.add_nuclide('Zn-70', 1.0e-12)
    fuel.add_nuclide('Ga-69', 1.0e-12)
    fuel.add_nuclide('Ga-71', 1.0e-12)
    fuel.add_nuclide('Ge-70', 1.0e-12)
    fuel.add_nuclide('Ge-72', 1.0e-12)
    fuel.add_nuclide('Ge-73', 1.0e-12)
    fuel.add_nuclide('Ge-74', 1.0e-12)
    fuel.add_nuclide('Ge-76', 1.0e-12)
    fuel.add_nuclide('As-74', 1.0e-12)
    fuel.add_nuclide('As-75', 1.0e-12)
    fuel.add_nuclide('Se-74', 1.0e-12)
    fuel.add_nuclide('Se-76', 1.0e-12)
    fuel.add_nuclide('Se-77', 1.0e-12)
    fuel.add_nuclide('Se-78', 1.0e-12)
    fuel.add_nuclide('Se-79', 1.0e-12)
    fuel.add_nuclide('Se-80', 1.0e-12)
    fuel.add_nuclide('Se-82', 1.0e-12)
    fuel.add_nuclide('Br-79', 1.0e-12)
    fuel.add_nuclide('Br-81', 1.0e-12)
    fuel.add_nuclide('Kr-78', 1.0e-12)
    fuel.add_nuclide('Kr-80', 1.0e-12)
    fuel.add_nuclide('Kr-82', 1.0e-12)
    fuel.add_nuclide('Kr-83', 1.0e-12)
    fuel.add_nuclide('Kr-84', 1.0e-12)
    fuel.add_nuclide('Kr-85', 1.0e-12)
    fuel.add_nuclide('Kr-86', 1.0e-12)
    fuel.add_nuclide('Rb-85', 1.0e-12)
    fuel.add_nuclide('Rb-86', 1.0e-12)
    fuel.add_nuclide('Rb-87', 1.0e-12)
    fuel.add_nuclide('Sr-84', 1.0e-12)
    fuel.add_nuclide('Sr-86', 1.0e-12)
    fuel.add_nuclide('Sr-87', 1.0e-12)
    fuel.add_nuclide('Sr-88', 1.0e-12)
    fuel.add_nuclide('Sr-89', 1.0e-12)
    fuel.add_nuclide('Sr-90', 1.0e-12)
    fuel.add_nuclide('Y-89', 1.0e-12)
    fuel.add_nuclide('Y-90', 1.0e-12)
    fuel.add_nuclide('Y-91', 1.0e-12)
    fuel.add_nuclide('Zr-90', 1.0e-12)
    fuel.add_nuclide('Zr-91', 1.0e-12)
    fuel.add_nuclide('Zr-92', 1.0e-12)
    fuel.add_nuclide('Zr-93', 1.0e-12)
    fuel.add_nuclide('Zr-94', 1.0e-12)
    fuel.add_nuclide('Zr-95', 1.0e-12)
    fuel.add_nuclide('Zr-96', 1.0e-12)
    fuel.add_nuclide('Nb-93', 1.0e-12)
    fuel.add_nuclide('Nb-94', 1.0e-12)
    fuel.add_nuclide('Nb-95', 1.0e-12)
    fuel.add_nuclide('Mo-92', 1.0e-12)
    fuel.add_nuclide('Mo-94', 1.0e-12)
    fuel.add_nuclide('Mo-96', 1.0e-12)
    fuel.add_nuclide('Mo-97', 1.0e-12)
    fuel.add_nuclide('Mo-98', 1.0e-12)
    fuel.add_nuclide('Mo-99', 1.0e-12)
    fuel.add_nuclide('Mo-100', 1.0e-12)
    fuel.add_nuclide('Ru-96', 1.0e-12)
    fuel.add_nuclide('Ru-98', 1.0e-12)
    fuel.add_nuclide('Ru-99', 1.0e-12)
    fuel.add_nuclide('Ru-100', 1.0e-12)
    fuel.add_nuclide('Ru-102', 1.0e-12)
    fuel.add_nuclide('Ru-104', 1.0e-12)
    fuel.add_nuclide('Ru-105', 1.0e-12)
    fuel.add_nuclide('Ru-106', 1.0e-12)
    fuel.add_nuclide('Rh-103', 1.0e-12)
    fuel.add_nuclide('Rh-105', 1.0e-12)
    fuel.add_nuclide('Pd-102', 1.0e-12)
    fuel.add_nuclide('Pd-104', 1.0e-12)
    fuel.add_nuclide('Pd-105', 1.0e-12)
    fuel.add_nuclide('Pd-106', 1.0e-12)
    fuel.add_nuclide('Pd-107', 1.0e-12)
    fuel.add_nuclide('Pd-108', 1.0e-12)
    fuel.add_nuclide('Pd-110', 1.0e-12)
    fuel.add_nuclide('Ag-107', 1.0e-12)
    fuel.add_nuclide('Ag-110m', 1.0e-12)
    fuel.add_nuclide('Ag-111', 1.0e-12)
    fuel.add_nuclide('Cd-106', 1.0e-12)
    fuel.add_nuclide('Cd-108', 1.0e-12)
    fuel.add_nuclide('Cd-110', 1.0e-12)
    fuel.add_nuclide('Cd-111', 1.0e-12)
    fuel.add_nuclide('Cd-112', 1.0e-12)
    fuel.add_nuclide('Cd-113', 1.0e-12)
    fuel.add_nuclide('Cd-114', 1.0e-12)
    fuel.add_nuclide('Cd-115m', 1.0e-12)
    fuel.add_nuclide('Cd-116', 1.0e-12)
    fuel.add_nuclide('In-113', 1.0e-12)
    fuel.add_nuclide('In-115', 1.0e-12)
    fuel.add_nuclide('Sn-112', 1.0e-12)
    fuel.add_nuclide('Sn-113', 1.0e-12)
    fuel.add_nuclide('Sn-114', 1.0e-12)
    fuel.add_nuclide('Sn-115', 1.0e-12)
    fuel.add_nuclide('Sn-116', 1.0e-12)
    fuel.add_nuclide('Sn-117', 1.0e-12)
    fuel.add_nuclide('Sn-118', 1.0e-12)
    fuel.add_nuclide('Sn-119', 1.0e-12)
    fuel.add_nuclide('Sn-120', 1.0e-12)
    fuel.add_nuclide('Sn-122', 1.0e-12)
    fuel.add_nuclide('Sn-123', 1.0e-12)
    fuel.add_nuclide('Sn-124', 1.0e-12)
    fuel.add_nuclide('Sn-125', 1.0e-12)
    fuel.add_nuclide('Sn-126', 1.0e-12)
    fuel.add_nuclide('Sb-121', 1.0e-12)
    fuel.add_nuclide('Sb-123', 1.0e-12)
    fuel.add_nuclide('Sb-124', 1.0e-12)
    fuel.add_nuclide('Sb-125', 1.0e-12)
    fuel.add_nuclide('Sb-126', 1.0e-12)
    fuel.add_nuclide('Te-120', 1.0e-12)
    fuel.add_nuclide('Te-122', 1.0e-12)
    fuel.add_nuclide('Te-123', 1.0e-12)
    fuel.add_nuclide('Te-124', 1.0e-12)
    fuel.add_nuclide('Te-125', 1.0e-12)
    fuel.add_nuclide('Te-126', 1.0e-12)
    fuel.add_nuclide('Te-127m', 1.0e-12)
    fuel.add_nuclide('Te-128', 1.0e-12)
    fuel.add_nuclide('Te-129m', 1.0e-12)
    fuel.add_nuclide('Te-130', 1.0e-12)
    fuel.add_nuclide('Te-132', 1.0e-12)
    fuel.add_nuclide('I-127', 1.0e-12)
    fuel.add_nuclide('I-129', 1.0e-12)
    fuel.add_nuclide('I-130', 1.0e-12)
    fuel.add_nuclide('I-131', 1.0e-12)
    fuel.add_nuclide('I-135', 1.0e-12)
    fuel.add_nuclide('Xe-124', 1.0e-12)
    fuel.add_nuclide('Xe-126', 1.0e-12)
    fuel.add_nuclide('Xe-128', 1.0e-12)
    fuel.add_nuclide('Xe-129', 1.0e-12)
    fuel.add_nuclide('Xe-130', 1.0e-12)
    fuel.add_nuclide('Xe-131', 1.0e-12)
    fuel.add_nuclide('Xe-132', 1.0e-12)
    fuel.add_nuclide('Xe-133', 1.0e-12)
    fuel.add_nuclide('Xe-134', 1.0e-12)
    fuel.add_nuclide('Xe-136', 1.0e-12)
    fuel.add_nuclide('Cs-134', 1.0e-12)
    fuel.add_nuclide('Cs-135', 1.0e-12)
    fuel.add_nuclide('Cs-136', 1.0e-12)
    fuel.add_nuclide('Cs-137', 1.0e-12)
    fuel.add_nuclide('Ba-132', 1.0e-12)
    fuel.add_nuclide('Ba-133', 1.0e-12)
    fuel.add_nuclide('Ba-134', 1.0e-12)
    fuel.add_nuclide('Ba-135', 1.0e-12)
    fuel.add_nuclide('Ba-136', 1.0e-12)
    fuel.add_nuclide('Ba-137', 1.0e-12)
    fuel.add_nuclide('Ba-138', 1.0e-12)
    fuel.add_nuclide('Ba-140', 1.0e-12)
    fuel.add_nuclide('La-138', 1.0e-12)
    fuel.add_nuclide('La-139', 1.0e-12)
    fuel.add_nuclide('La-140', 1.0e-12)
    fuel.add_nuclide('Ce-138', 1.0e-12)
    fuel.add_nuclide('Ce-139', 1.0e-12)
    fuel.add_nuclide('Ce-140', 1.0e-12)
    fuel.add_nuclide('Ce-141', 1.0e-12)
    fuel.add_nuclide('Ce-142', 1.0e-12)
    fuel.add_nuclide('Ce-143', 1.0e-12)
    fuel.add_nuclide('Ce-144', 1.0e-12)
    fuel.add_nuclide('Pr-141', 1.0e-12)
    fuel.add_nuclide('Pr-142', 1.0e-12)
    fuel.add_nuclide('Pr-143', 1.0e-12)
    fuel.add_nuclide('Nd-142', 1.0e-12)
    fuel.add_nuclide('Nd-144', 1.0e-12)
    fuel.add_nuclide('Nd-146', 1.0e-12)
    fuel.add_nuclide('Nd-147', 1.0e-12)
    fuel.add_nuclide('Nd-148', 1.0e-12)
    fuel.add_nuclide('Nd-150', 1.0e-12)
    fuel.add_nuclide('Pm-147', 1.0e-12)
    fuel.add_nuclide('Pm-148', 1.0e-12)
    fuel.add_nuclide('Pm-148m', 1.0e-12)
    fuel.add_nuclide('Pm-149', 1.0e-12)
    fuel.add_nuclide('Pm-151', 1.0e-12)
    fuel.add_nuclide('Sm-144', 1.0e-12)
    fuel.add_nuclide('Sm-148', 1.0e-12)
    fuel.add_nuclide('Sm-153', 1.0e-12)
    fuel.add_nuclide('Sm-154', 1.0e-12)
    fuel.add_nuclide('Eu-151', 1.0e-12)
    fuel.add_nuclide('Eu-152', 1.0e-12)
    fuel.add_nuclide('Eu-154', 1.0e-12)
    fuel.add_nuclide('Eu-155', 1.0e-12)
    fuel.add_nuclide('Eu-156', 1.0e-12)
    fuel.add_nuclide('Eu-157', 1.0e-12)
    fuel.add_nuclide('Gd-152', 1.0e-12)
    fuel.add_nuclide('Gd-153', 1.0e-12)
    fuel.add_nuclide('Gd-154', 1.0e-12)
    fuel.add_nuclide('Gd-156', 1.0e-12)
    fuel.add_nuclide('Gd-157', 1.0e-12)
    fuel.add_nuclide('Gd-158', 1.0e-12)
    fuel.add_nuclide('Gd-160', 1.0e-12)
    fuel.add_nuclide('Tb-159', 1.0e-12)
    fuel.add_nuclide('Tb-160', 1.0e-12)
    fuel.add_nuclide('Dy-156', 1.0e-12)
    fuel.add_nuclide('Dy-158', 1.0e-12)
    fuel.add_nuclide('Dy-160', 1.0e-12)
    fuel.add_nuclide('Dy-161', 1.0e-12)
    fuel.add_nuclide('Dy-162', 1.0e-12)
    fuel.add_nuclide('Dy-163', 1.0e-12)
    fuel.add_nuclide('Dy-164', 1.0e-12)
    fuel.add_nuclide('Ho-165', 1.0e-12)
    fuel.add_nuclide('Ho-166m', 1.0e-12)
    fuel.add_nuclide('Er-162', 1.0e-12)
    fuel.add_nuclide('Er-164', 1.0e-12)
    fuel.add_nuclide('Er-166', 1.0e-12)
    fuel.add_nuclide('Er-167', 1.0e-12)
    fuel.add_nuclide('Er-168', 1.0e-12)
    fuel.add_nuclide('Er-170', 1.0e-12)
    fuel.add_nuclide('Tm-168', 1.0e-12)
    fuel.add_nuclide('Tm-169', 1.0e-12)
    fuel.add_nuclide('Tm-170', 1.0e-12)
    # minor actinides
    fuel.add_nuclide('U-233', 1.0e-12)
    fuel.add_nuclide('U-237', 1.0e-12)
    fuel.add_nuclide('Np-238', 1.0e-12)
    fuel.add_nuclide('Cm-246', 1.0e-12)
    # other reaction products from (n,p), (n,a), etc.
    fuel.add_nuclide('H-1', 1.0e-12)
    fuel.add_nuclide('H-2', 1.0e-12)
    fuel.add_nuclide('H-3', 1.0e-12)
    fuel.add_nuclide('He-3', 1.0e-12)
    fuel.add_nuclide('He-4', 1.0e-12)

clad = openmc.Material(name='Cladding', material_id=2)
clad.set_density('g/cm3', 5.77)
clad.add_element("Zr", 1.0)

cold_water = openmc.Material(name='Cold borated water', material_id=3)
cold_water.set_density('atom/b-cm', 0.07416)
cold_water.add_nuclide("H-1", 2.0)
cold_water.add_nuclide("O-16", 1.0)
cold_water.add_nuclide("B-10", 6.490e-4)
cold_water.add_nuclide("B-11", 2.689e-3)
cold_water.add_s_alpha_beta('HH2O', '71t')

hot_water = openmc.Material(name='Hot borated water', material_id=4)
hot_water.set_density('atom/b-cm', 0.06614)
hot_water.add_nuclide("H-1", 2.0)
hot_water.add_nuclide("O-16", 1.0)
hot_water.add_nuclide("B-10", 6.490e-4)
hot_water.add_nuclide("B-11", 2.689e-3)
hot_water.add_s_alpha_beta('HH2O', '71t')

rpv_steel = openmc.Material(name='Reactor pressure vessel steel',
                            material_id=5)
rpv_steel.set_density('g/cm3', 7.9)
rpv_steel.add_nuclide("Fe-54", 0.05437098, 'wo')
rpv_steel.add_nuclide("Fe-56", 0.88500663, 'wo')
rpv_steel.add_nuclide("Fe-57", 0.0208008, 'wo')
rpv_steel.add_nuclide("Fe-58", 0.00282159, 'wo')
rpv_steel.add_nuclide("Ni-58", 0.0067198, 'wo')
rpv_steel.add_nuclide("Ni-60", 0.0026776, 'wo')
rpv_steel.add_nuclide("Ni-61", 0.0001183, 'wo')
rpv_steel.add_nuclide("Ni-62", 0.0003835, 'wo')
rpv_steel.add_nuclide("Ni-64", 0.0001008, 'wo')
rpv_steel.add_nuclide("Mn-55", 0.01, 'wo')
rpv_steel.add_nuclide("Mo-92", 0.000849, 'wo')
rpv_steel.add_nuclide("Mo-94", 0.0005418, 'wo')
rpv_steel.add_nuclide("Mo-95", 0.0009438, 'wo')
rpv_steel.add_nuclide("Mo-96", 0.0010002, 'wo')
rpv_steel.add_nuclide("Mo-97", 0.0005796, 'wo')
rpv_steel.add_nuclide("Mo-98", 0.0014814, 'wo')
rpv_steel.add_nuclide("Mo-100", 0.0006042, 'wo')
rpv_steel.add_nuclide("Si-28", 0.00367464, 'wo')
rpv_steel.add_nuclide("Si-29", 0.00019336, 'wo')
rpv_steel.add_nuclide("Si-30", 0.000132, 'wo')
rpv_steel.add_nuclide("Cr-50", 0.00010435, 'wo')
rpv_steel.add_nuclide("Cr-52", 0.002092475, 'wo')
rpv_steel.add_nuclide("Cr-53", 0.00024185, 'wo')
rpv_steel.add_nuclide("Cr-54", 6.1325e-05, 'wo')
rpv_steel.add_nuclide("C-Nat", 0.0025, 'wo')
rpv_steel.add_nuclide("Cu-63", 0.0013696, 'wo')
rpv_steel.add_nuclide("Cu-65", 0.0006304, 'wo')

lower_rad_ref = openmc.Material(name='Lower radial reflector',
                                material_id=6)
lower_rad_ref.set_density('g/cm3', 4.32)
lower_rad_ref.add_nuclide("H-1", 0.0095661, 'wo')
lower_rad_ref.add_nuclide("O-16", 0.0759107, 'wo')
lower_rad_ref.add_nuclide("B-10", 3.08409e-5, 'wo')
lower_rad_ref.add_nuclide("B-11", 1.40499e-4, 'wo')
lower_rad_ref.add_nuclide("Fe-54", 0.035620772088, 'wo')
lower_rad_ref.add_nuclide("Fe-56", 0.579805982228, 'wo')
lower_rad_ref.add_nuclide("Fe-57", 0.01362750048, 'wo')
lower_rad_ref.add_nuclide("Fe-58", 0.001848545204, 'wo')
lower_rad_ref.add_nuclide("Ni-58", 0.055298376566, 'wo')
lower_rad_ref.add_nuclide("Ni-60", 0.022034425592, 'wo')
lower_rad_ref.add_nuclide("Ni-61", 0.000973510811, 'wo')
lower_rad_ref.add_nuclide("Ni-62", 0.003155886695, 'wo')
lower_rad_ref.add_nuclide("Ni-64", 0.000829500336, 'wo')
lower_rad_ref.add_nuclide("Mn-55", 0.0182870, 'wo')
lower_rad_ref.add_nuclide("Si-28", 0.00839976771, 'wo')
lower_rad_ref.add_nuclide("Si-29", 0.00044199679, 'wo')
lower_rad_ref.add_nuclide("Si-30", 0.0003017355, 'wo')
lower_rad_ref.add_nuclide("Cr-50", 0.007251360806, 'wo')
lower_rad_ref.add_nuclide("Cr-52", 0.145407678031, 'wo')
lower_rad_ref.add_nuclide("Cr-53", 0.016806340306, 'wo')
lower_rad_ref.add_nuclide("Cr-54", 0.004261520857, 'wo')
lower_rad_ref.add_s_alpha_beta('HH2O', '71t')

upper_rad_ref = openmc.Material(name='Upper radial reflector /'
                                'Top plate region', material_id=7)
upper_rad_ref.set_density('g/cm3', 4.28)
upper_rad_ref.add_nuclide("H-1", 0.0086117, 'wo')
upper_rad_ref.add_nuclide("O-16", 0.0683369, 'wo')
upper_rad_ref.add_nuclide("B-10", 2.77638e-5, 'wo')
upper_rad_ref.add_nuclide("B-11", 1.26481e-4, 'wo')
upper_rad_ref.add_nuclide("Fe-54", 0.035953677186, 'wo')
upper_rad_ref.add_nuclide("Fe-56", 0.585224740891, 'wo')
upper_rad_ref.add_nuclide("Fe-57", 0.01375486056, 'wo')
upper_rad_ref.add_nuclide("Fe-58", 0.001865821363, 'wo')
upper_rad_ref.add_nuclide("Ni-58", 0.055815129186, 'wo')
upper_rad_ref.add_nuclide("Ni-60", 0.022240333032, 'wo')
upper_rad_ref.add_nuclide("Ni-61", 0.000982608081, 'wo')
upper_rad_ref.add_nuclide("Ni-62", 0.003185377845, 'wo')
upper_rad_ref.add_nuclide("Ni-64", 0.000837251856, 'wo')
upper_rad_ref.add_nuclide("Mn-55", 0.0184579, 'wo')
upper_rad_ref.add_nuclide("Si-28", 0.00847831314, 'wo')
upper_rad_ref.add_nuclide("Si-29", 0.00044612986, 'wo')
upper_rad_ref.add_nuclide("Si-30", 0.000304557, 'wo')
upper_rad_ref.add_nuclide("Cr-50", 0.00731912987, 'wo')
upper_rad_ref.add_nuclide("Cr-52", 0.146766614995, 'wo')
upper_rad_ref.add_nuclide("Cr-53", 0.01696340737, 'wo')
upper_rad_ref.add_nuclide("Cr-54", 0.004301347765, 'wo')
upper_rad_ref.add_s_alpha_beta('HH2O', '71t')

bot_plate = openmc.Material(name='Bottom plate region', material_id=8)
bot_plate.set_density('g/cm3', 7.184)
bot_plate.add_nuclide("H-1", 0.0011505, 'wo')
bot_plate.add_nuclide("O-16", 0.0091296, 'wo')
bot_plate.add_nuclide("B-10", 3.70915e-6, 'wo')
bot_plate.add_nuclide("B-11", 1.68974e-5, 'wo')
bot_plate.add_nuclide("Fe-54", 0.03855611055, 'wo')
bot_plate.add_nuclide("Fe-56", 0.627585036425, 'wo')
bot_plate.add_nuclide("Fe-57", 0.014750478, 'wo')
bot_plate.add_nuclide("Fe-58", 0.002000875025, 'wo')
bot_plate.add_nuclide("Ni-58", 0.059855207342, 'wo')
bot_plate.add_nuclide("Ni-60", 0.023850159704, 'wo')
bot_plate.add_nuclide("Ni-61", 0.001053732407, 'wo')
bot_plate.add_nuclide("Ni-62", 0.003415945715, 'wo')
bot_plate.add_nuclide("Ni-64", 0.000897854832, 'wo')
bot_plate.add_nuclide("Mn-55", 0.0197940, 'wo')
bot_plate.add_nuclide("Si-28", 0.00909197802, 'wo')
bot_plate.add_nuclide("Si-29", 0.00047842098, 'wo')
bot_plate.add_nuclide("Si-30", 0.000326601, 'wo')
bot_plate.add_nuclide("Cr-50", 0.007848910646, 'wo')
bot_plate.add_nuclide("Cr-52", 0.157390026871, 'wo')
bot_plate.add_nuclide("Cr-53", 0.018191270146, 'wo')
bot_plate.add_nuclide("Cr-54", 0.004612692337, 'wo')
bot_plate.add_s_alpha_beta('HH2O', '71t')

bot_nozzle = openmc.Material(name='Bottom nozzle region', material_id=9)
bot_nozzle.set_density('g/cm3', 2.53)
bot_nozzle.add_nuclide("H-1", 0.0245014, 'wo')
bot_nozzle.add_nuclide("O-16", 0.1944274, 'wo')
bot_nozzle.add_nuclide("B-10", 7.89917e-5, 'wo')
bot_nozzle.add_nuclide("B-11", 3.59854e-4, 'wo')
bot_nozzle.add_nuclide("Fe-54", 0.030411411144, 'wo')
bot_nozzle.add_nuclide("Fe-56", 0.495012237964, 'wo')
bot_nozzle.add_nuclide("Fe-57", 0.01163454624, 'wo')
bot_nozzle.add_nuclide("Fe-58", 0.001578204652, 'wo')
bot_nozzle.add_nuclide("Ni-58", 0.047211231662, 'wo')
bot_nozzle.add_nuclide("Ni-60", 0.018811987544, 'wo')
bot_nozzle.add_nuclide("Ni-61", 0.000831139127, 'wo')
bot_nozzle.add_nuclide("Ni-62", 0.002694352115, 'wo')
bot_nozzle.add_nuclide("Ni-64", 0.000708189552, 'wo')
bot_nozzle.add_nuclide("Mn-55", 0.0156126, 'wo')
bot_nozzle.add_nuclide("Si-28", 0.007171335558, 'wo')
bot_nozzle.add_nuclide("Si-29", 0.000377356542, 'wo')
bot_nozzle.add_nuclide("Si-30", 0.0002576079, 'wo')
bot_nozzle.add_nuclide("Cr-50", 0.006190885148, 'wo')
bot_nozzle.add_nuclide("Cr-52", 0.124142524198, 'wo')
bot_nozzle.add_nuclide("Cr-53", 0.014348496148, 'wo')
bot_nozzle.add_nuclide("Cr-54", 0.003638294506, 'wo')
bot_nozzle.add_s_alpha_beta('HH2O', '71t')

top_nozzle = openmc.Material(name='Top nozzle region', material_id=10)
top_nozzle.set_density('g/cm3', 1.746)
top_nozzle.add_nuclide("H-1", 0.0358870, 'wo')
top_nozzle.add_nuclide("O-16", 0.2847761, 'wo')
top_nozzle.add_nuclide("B-10", 1.15699e-4, 'wo')
top_nozzle.add_nuclide("B-11", 5.27075e-4, 'wo')
top_nozzle.add_nuclide("Fe-54", 0.02644016154, 'wo')
top_nozzle.add_nuclide("Fe-56", 0.43037146399, 'wo')
top_nozzle.add_nuclide("Fe-57", 0.0101152584, 'wo')
top_nozzle.add_nuclide("Fe-58", 0.00137211607, 'wo')
top_nozzle.add_nuclide("Ni-58", 0.04104621835, 'wo')
top_nozzle.add_nuclide("Ni-60", 0.0163554502, 'wo')
top_nozzle.add_nuclide("Ni-61", 0.000722605975, 'wo')
top_nozzle.add_nuclide("Ni-62", 0.002342513875, 'wo')
top_nozzle.add_nuclide("Ni-64", 0.0006157116, 'wo')
top_nozzle.add_nuclide("Mn-55", 0.0135739, 'wo')
top_nozzle.add_nuclide("Si-28", 0.006234853554, 'wo')
top_nozzle.add_nuclide("Si-29", 0.000328078746, 'wo')
top_nozzle.add_nuclide("Si-30", 0.0002239677, 'wo')
top_nozzle.add_nuclide("Cr-50", 0.005382452306, 'wo')
top_nozzle.add_nuclide("Cr-52", 0.107931450781, 'wo')
top_nozzle.add_nuclide("Cr-53", 0.012474806806, 'wo')
top_nozzle.add_nuclide("Cr-54", 0.003163190107, 'wo')
top_nozzle.add_s_alpha_beta('HH2O', '71t')

top_fa = openmc.Material(name='Top of fuel assemblies', material_id=11)
top_fa.set_density('g/cm3', 3.044)
top_fa.add_nuclide("H-1", 0.0162913, 'wo')
top_fa.add_nuclide("O-16", 0.1292776, 'wo')
top_fa.add_nuclide("B-10", 5.25228e-5, 'wo')
top_fa.add_nuclide("B-11", 2.39272e-4, 'wo')
top_fa.add_nuclide("Zr-90", 0.43313403903, 'wo')
top_fa.add_nuclide("Zr-91", 0.09549277374, 'wo')
top_fa.add_nuclide("Zr-92", 0.14759527104, 'wo')
top_fa.add_nuclide("Zr-94", 0.15280552077, 'wo')
top_fa.add_nuclide("Zr-96", 0.02511169542, 'wo')
top_fa.add_s_alpha_beta('HH2O', '71t')

bot_fa = openmc.Material(name='Bottom of fuel assemblies', material_id=12)
bot_fa.set_density('g/cm3', 1.762)
bot_fa.add_nuclide("H-1", 0.0292856, 'wo')
bot_fa.add_nuclide("O-16", 0.2323919, 'wo')
bot_fa.add_nuclide("B-10", 9.44159e-5, 'wo')
bot_fa.add_nuclide("B-11", 4.30120e-4, 'wo')
bot_fa.add_nuclide("Zr-90", 0.3741373658, 'wo')
bot_fa.add_nuclide("Zr-91", 0.0824858164, 'wo')
bot_fa.add_nuclide("Zr-92", 0.1274914944, 'wo')
bot_fa.add_nuclide("Zr-94", 0.1319920622, 'wo')
bot_fa.add_nuclide("Zr-96", 0.0216912612, 'wo')
bot_fa.add_s_alpha_beta('HH2O', '71t')

# Define the materials file.
materials = openmc.Materials()
materials.default_xs = '71c'
materials += [fuel, clad, cold_water, hot_water, rpv_steel,
              lower_rad_ref, upper_rad_ref, bot_plate,
              bot_nozzle, top_nozzle, top_fa, bot_fa]
materials.export_to_xml()

# Define surfaces.
s1 = openmc.ZCylinder(R=0.41, surface_id=1)
s2 = openmc.ZCylinder(R=0.475, surface_id=2)
s3 = openmc.ZCylinder(R=0.56, surface_id=3)
s4 = openmc.ZCylinder(R=0.62, surface_id=4)
s5 = openmc.ZCylinder(R=187.6, surface_id=5)
s6 = openmc.ZCylinder(R=209.0, surface_id=6)
s7 = openmc.ZCylinder(R=229.0, surface_id=7)
s8 = openmc.ZCylinder(R=249.0, surface_id=8)
s8.boundary_type = 'vacuum'

s31 = openmc.ZPlane(z0=-229.0, surface_id=31)
s31.boundary_type = 'vacuum'
s32 = openmc.ZPlane(z0=-199.0, surface_id=32)
s33 = openmc.ZPlane(z0=-193.0, surface_id=33)
s34 = openmc.ZPlane(z0=-183.0, surface_id=34)
s35 = openmc.ZPlane(z0=0.0, surface_id=35)
s36 = openmc.ZPlane(z0=183.0, surface_id=36)
s37 = openmc.ZPlane(z0=203.0, surface_id=37)
s38 = openmc.ZPlane(z0=215.0, surface_id=38)
s39 = openmc.ZPlane(z0=223.0, surface_id=39)
s39.boundary_type = 'vacuum'

# Define pin cells.
c21 = openmc.Cell(cell_id=21, fill=fuel, region=-s1)
c22 = openmc.Cell(cell_id=22, fill=clad, region=+s1 & -s2)
c23 = openmc.Cell(cell_id=23, fill=cold_water, region=+s2)
fuel_cold = openmc.Universe(name='Fuel pin, cladding, cold water',
                            universe_id=1, cells=(c21, c22, c23))

c24 = openmc.Cell(cell_id=24, fill=cold_water, region=-s3)
c25 = openmc.Cell(cell_id=25, fill=clad, region=+s3 & -s4)
c26 = openmc.Cell(cell_id=26, fill=cold_water, region=+s4)
tube_cold = openmc.Universe(name='Instrumentation guide tube, cold water',
                            universe_id=2, cells=(c24, c25, c26))

c27 = openmc.Cell(cell_id=27, fill=fuel, region=-s1)
c28 = openmc.Cell(cell_id=28, fill=clad, region=+s1 & -s2)
c29 = openmc.Cell(cell_id=29, fill=hot_water, region=+s2)
fuel_hot = openmc.Universe(name='Fuel pin, cladding, hot water',
                           universe_id=3, cells=(c27, c28, c29))

c30 = openmc.Cell(cell_id=30, fill=hot_water, region=-s3)
c31 = openmc.Cell(cell_id=31, fill=clad, region=+s3 & -s4)
c32 = openmc.Cell(cell_id=32, fill=hot_water, region=+s4)
tube_hot = openmc.Universe(name='Instrumentation guide tube, hot water',
                           universe_id=4, cells=(c30, c31, c32))

guide_tubes = [(2, 5), (2, 8), (2, 11), (3, 3), (3, 13),
               (5, 2), (5, 5), (5, 8), (5, 11), (5, 14),
               (8, 2), (8, 5), (8, 8), (8, 11), (8, 14),
               (11, 2), (11, 5), (11, 8), (11, 11), (11, 14),
               (13, 3), (13, 13), (14, 5), (14, 8), (14, 11)]

# Define fuel lattices.
l100 = openmc.RectLattice(name='Fuel assembly (lower half)', lattice_id=100)
l100.lower_left = (-10.71, -10.71)
l100.pitch = (1.26, 1.26)
l100.universes = np.tile(fuel_cold, (17, 17))
for position in guide_tubes:
    l100.universes[position] = tube_cold

l101 = openmc.RectLattice(name='Fuel assembly (upper half)', lattice_id=101)
l101.lower_left = (-10.71, -10.71)
l101.pitch = (1.26, 1.26)
l101.universes = np.tile(fuel_hot, (17, 17))
for position in guide_tubes:
    l101.universes[position] = tube_hot

# Define assemblies.
c50 = openmc.Cell(cell_id=50, fill=cold_water, region=+s34 & -s35)
fa_cw = openmc.Universe(name='Water assembly (cold)', universe_id=5, cells=[c50])

c70 = openmc.Cell(cell_id=70, fill=hot_water, region=+s35 & -s36)
fa_hw = openmc.Universe(name='Water assembly (hot)', universe_id=7, cells=[c70])

c60 = openmc.Cell(cell_id=60, fill=l100, region=+s34 & -s35)
fa_cold = openmc.Universe(name='Fuel assembly (cold)', universe_id=6, cells=[c60])

c80 = openmc.Cell(cell_id=80, fill=l101, region=+s35 & -s36)
fa_hot = openmc.Universe(name='Fuel assembly (hot)', universe_id=8, cells=[c80])

# Define core lattices
l200 = openmc.RectLattice(name='Core lattice (lower half)', lattice_id=200)
l200.lower_left = (-224.91, -224.91)
l200.pitch = (21.42, 21.42)
l200.universes = [
    [fa_cw]*21,
    [fa_cw]*21,
    [fa_cw]*7 + [fa_cold]*7 + [fa_cw]*7,
    [fa_cw]*5 + [fa_cold]*11 + [fa_cw]*5,
    [fa_cw]*4 + [fa_cold]*13 + [fa_cw]*4,
    [fa_cw]*3 + [fa_cold]*15 + [fa_cw]*3,
    [fa_cw]*3 + [fa_cold]*15 + [fa_cw]*3,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*2 + [fa_cold]*17 + [fa_cw]*2,
    [fa_cw]*3 + [fa_cold]*15 + [fa_cw]*3,
    [fa_cw]*3 + [fa_cold]*15 + [fa_cw]*3,
    [fa_cw]*4 + [fa_cold]*13 + [fa_cw]*4,
    [fa_cw]*5 + [fa_cold]*11 + [fa_cw]*5,
    [fa_cw]*7 + [fa_cold]*7 + [fa_cw]*7,
    [fa_cw]*21,
    [fa_cw]*21]

l201 = openmc.RectLattice(name='Core lattice (lower half)', lattice_id=201)
l201.lower_left = (-224.91, -224.91)
l201.pitch = (21.42, 21.42)
l201.universes = [
    [fa_hw]*21,
    [fa_hw]*21,
    [fa_hw]*7 + [fa_hot]*7 + [fa_hw]*7,
    [fa_hw]*5 + [fa_hot]*11 + [fa_hw]*5,
    [fa_hw]*4 + [fa_hot]*13 + [fa_hw]*4,
    [fa_hw]*3 + [fa_hot]*15 + [fa_hw]*3,
    [fa_hw]*3 + [fa_hot]*15 + [fa_hw]*3,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*2 + [fa_hot]*17 + [fa_hw]*2,
    [fa_hw]*3 + [fa_hot]*15 + [fa_hw]*3,
    [fa_hw]*3 + [fa_hot]*15 + [fa_hw]*3,
    [fa_hw]*4 + [fa_hot]*13 + [fa_hw]*4,
    [fa_hw]*5 + [fa_hot]*11 + [fa_hw]*5,
    [fa_hw]*7 + [fa_hot]*7 + [fa_hw]*7,
    [fa_hw]*21,
    [fa_hw]*21]

# Define root universe
c1 = openmc.Cell(cell_id=1, fill=l200, region=-s6 & +s34 & -s35)
c2 = openmc.Cell(cell_id=2, fill=l201, region=-s6 & +s35 & -s36)
c3 = openmc.Cell(cell_id=3, fill=bot_plate, region=-s7 & +s31 & -s32)
c4 = openmc.Cell(cell_id=4, fill=bot_nozzle, region=-s5 & +s32 & -s33)
c5 = openmc.Cell(cell_id=5, fill=bot_fa, region=-s5 & +s33 & -s34)
c6 = openmc.Cell(cell_id=6, fill=top_fa, region=-s5 & +s36 & -s37)
c7 = openmc.Cell(cell_id=7, fill=top_nozzle, region=-s5 & +s37 & -s38)
c8 = openmc.Cell(cell_id=8, fill=upper_rad_ref, region=-s7 & +s38 & -s39)
c9 = openmc.Cell(cell_id=9, fill=bot_nozzle, region=+s6 & -s7 & +s32 & -s38)
c10 = openmc.Cell(cell_id=10, fill=rpv_steel, region=+s7 & -s8 & +s31 & -s39)
c11 = openmc.Cell(cell_id=11, fill=lower_rad_ref, region=+s5 & -s6 & +s32 & -s34)
c12 = openmc.Cell(cell_id=12, fill=upper_rad_ref, region=+s5 & -s6 & +s36 & -s38)
root = openmc.Universe(universe_id=0, name='root universe',
                       cells=(c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12))

# Create and export geometry
geometry = openmc.Geometry(root)
geometry.export_to_xml()

settings = openmc.Settings()
settings.batches = 10
settings.inactive = 5
settings.particles = 100
settings.source = openmc.Source(space=openmc.stats.Box(
    [-160, -160, -183], [160, 160, 183]))
settings.export_to_xml()

plot = openmc.Plot()
plot.filename = 'mat'
plot.origin = (125, 125, 0)
plot.width = (250, 250)
plot.pixels = (3000, 3000)
plot.color = 'mat'
plots = openmc.Plots([plot])
plots.export_to_xml()
